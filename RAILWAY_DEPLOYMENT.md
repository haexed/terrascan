# üöÄ TERRASCAN Railway Production Deployment Guide

## Overview
This guide will help you deploy TERRASCAN as a production-ready environmental monitoring platform on Railway with PostgreSQL database.

## üìã Prerequisites

1. **Railway Account**: Sign up at [railway.app](https://railway.app)
2. **GitHub Repository**: Your TERRASCAN code should be in a GitHub repository
3. **API Keys**: Get free API keys for environmental data sources

## üîß Step 1: Railway Project Setup

### 1.1 Create New Railway Project
```bash
# Install Railway CLI (optional)
npm install -g @railway/cli

# Login to Railway
railway login

# Create new project
railway new
```

Or use the Railway web dashboard:
1. Go to [railway.app](https://railway.app)
2. Click "New Project"
3. Select "Deploy from GitHub repo"
4. Connect your TERRASCAN repository

### 1.2 Add PostgreSQL Database
```bash
# Using Railway CLI
railway add postgresql

# Or in Railway dashboard:
# 1. Go to your project
# 2. Click "New Service"
# 3. Select "Database" ‚Üí "PostgreSQL"
```

## üîë Step 2: Environment Variables

### 2.1 Required Environment Variables
Set these in Railway dashboard under "Variables" tab:

```bash
# Database (auto-generated by Railway)
DATABASE_URL=postgresql://user:password@host:port/database

# Weather Data (Required)
OPENWEATHER_API_KEY=your_openweather_api_key

# Fire Data (Optional - has free tier)
NASA_FIRMS_API_KEY=your_nasa_firms_api_key

# Flask Configuration
FLASK_ENV=production
SECRET_KEY=your_secret_key_here
```

### 2.2 Get API Keys

#### OpenWeatherMap (Required)
1. Go to [openweathermap.org](https://openweathermap.org/api)
2. Sign up for free account
3. Get API key from dashboard
4. Free tier: 1,000 calls/day

#### NASA FIRMS (Optional)
1. Go to [firms.modaps.eosdis.nasa.gov](https://firms.modaps.eosdis.nasa.gov/api/)
2. Request API key (free)
3. Or use without key (limited access)

## üóÑÔ∏è Step 3: Database Setup

### 3.1 Run Production Setup Script
After deployment, run the setup script to initialize the database:

```bash
# SSH into Railway container (if CLI available)
railway shell

# Or create a one-time deployment script
python setup_production_railway.py
```

### 3.2 Manual Database Setup (Alternative)
If you need to set up manually, the script will:
- Create all necessary tables (PostgreSQL schema)
- Set up system and provider configurations
- Create 10 environmental monitoring tasks
- Configure indexes for performance

## üåç Step 4: Environmental Data Sources

TERRASCAN will monitor these data sources:

### üî• Fire Monitoring
- **NASA FIRMS**: Global fire detection
- **Coverage**: Worldwide satellite monitoring
- **Update**: Every 2 hours

### üå¨Ô∏è Air Quality
- **OpenAQ**: Global air quality measurements
- **Coverage**: 65+ major cities
- **Update**: Every hour

### üåä Ocean Data
- **NOAA Ocean Service**: Ocean temperature & water levels
- **Coverage**: 12 major coastal stations
- **Update**: Every 3 hours

### ‚õàÔ∏è Weather Data
- **OpenWeatherMap**: Weather data & alerts
- **Coverage**: 24 global cities
- **Update**: Every 2 hours

### ü¶ã Biodiversity
- **GBIF**: Species observations & diversity
- **Coverage**: 18 biodiversity hotspots
- **Update**: Every 6-12 hours

## üöÄ Step 5: Deployment

### 5.1 Deploy to Railway
```bash
# Using Railway CLI
railway up

# Or push to GitHub (if connected)
git push origin main
```

### 5.2 Verify Deployment
1. Check Railway dashboard for successful deployment
2. Visit your app URL: `https://your-app.railway.app`
3. Check system status: `https://your-app.railway.app/system`

## üîç Step 6: Production Verification

### 6.1 Check Database Connection
```bash
curl https://your-app.railway.app/health
```

### 6.2 Verify Data Collection
```bash
# Trigger biodiversity data collection
curl https://your-app.railway.app/api/collect-biodiversity

# Check system status
curl https://your-app.railway.app/system
```

### 6.3 Monitor Environmental Health
Visit your dashboard to see:
- Real-time environmental health score
- Global fire activity
- Air quality measurements
- Ocean temperature data
- Weather conditions
- Biodiversity metrics

## üìä Step 7: Monitoring & Maintenance

### 7.1 Database Monitoring
- Railway provides built-in PostgreSQL monitoring
- Check database size and performance in Railway dashboard
- Set up alerts for database issues

### 7.2 Application Monitoring
- Monitor task execution in `/system` page
- Check API response times
- Monitor data collection success rates

### 7.3 Cost Management
- Railway PostgreSQL: $5/month for production
- OpenWeatherMap: Free tier (1,000 calls/day)
- NASA FIRMS: Free
- OpenAQ: Free
- GBIF: Free
- NOAA: Free

## üîß Troubleshooting

### Database Connection Issues
```bash
# Check DATABASE_URL is set
echo $DATABASE_URL

# Test connection
python -c "import psycopg2; psycopg2.connect('$DATABASE_URL')"
```

### Missing Data
1. Check environment variables are set
2. Verify API keys are valid
3. Check task logs in `/system` page
4. Run manual data collection endpoints

### Performance Issues
1. Check database indexes are created
2. Monitor Railway resource usage
3. Consider upgrading Railway plan if needed

## üéØ Production Checklist

- [ ] Railway project created
- [ ] PostgreSQL database added
- [ ] Environment variables configured
- [ ] API keys obtained and set
- [ ] Application deployed successfully
- [ ] Database schema initialized
- [ ] Environmental tasks configured
- [ ] Data collection verified
- [ ] Dashboard accessible
- [ ] System monitoring active

## üåç Success!

Your TERRASCAN environmental monitoring platform is now running in production on Railway with:

- **PostgreSQL database** for scalable data storage
- **10 environmental monitoring tasks** collecting real-time data
- **5 major data sources** (NASA, OpenAQ, NOAA, OpenWeatherMap, GBIF)
- **Global coverage** of fires, air quality, ocean, weather, and biodiversity
- **Real-time dashboard** with environmental health scoring
- **Production-ready architecture** with proper error handling and monitoring

Visit your dashboard and start monitoring our planet! üåçüíö 
